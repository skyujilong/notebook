# V8 GC

## 清除方案

### 计数引用清除

计算变量的引用次数，当引用次数为零的时候，释放该变量。

*缺点，在早期的ie浏览器中，该方案，在eg:dom这种循环引用的结构，会导致，无法正确的释放内存。也就是内存泄漏。*

### 标记清除（V8采用）

标记-清除算法由标记阶段和清除阶段构成。在标记阶段会把所有的活动对象都做上标记，然后在清除阶段会把没有标记的对象，也就是非活动对象回收。

*活动对象:能通过引用程序引用的对象就被称为活动对象。（可以直接或间接从全局变量空间中引出的对象）*

*非活动对象:不能通过程序引用的对象呗称为非活动对象。（这就是被清除的目标）*

**过程**

算法执行的时候，需要进行标记存活的变量，清算阶段，需要遍历整个堆栈，查找未标记的变量，然后进行清除操作。


**缺点**
1. 效率不高，需要遍历整个堆栈。
2. 清理出来的内存不够连续。


## 垃圾收集过程

V8采用的是标记清除算法，但是又有所区别。

### Generational layout（代）

v8将堆栈划分为不同的部分，称之为Generational（代）【划分为年轻代与老年代】，年轻代（young generation）划分为两个部分，一个nursery，另外一个是intermediate。

![v8 代](ttps://github.com/skyujilong/notebook/blob/master/src/generational-layer.svg)




